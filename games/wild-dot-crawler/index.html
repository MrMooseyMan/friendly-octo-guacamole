<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Wild Dot Crawler</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <main class="app" aria-label="Wild Dot Crawler">
    <header class="topbar">
      <div class="title">
        <div class="game-name">ğŸº Wild Dot Crawler</div>
        <div class="sub">Chain tiles â€¢ Slay monsters â€¢ Climb floors!</div>
      </div>

      <div class="stats" aria-label="Stats">
        <div class="stat hp-stat">
          <span class="k">â¤ï¸ HP</span>
          <div class="hp-bar-wrap">
            <div id="hpBar" class="hp-bar" style="width: 100%"></div>
            <span id="hpText" class="hp-text">10/10</span>
          </div>
        </div>
        <div class="stat"><span class="k">ğŸ›¡ï¸</span> <span id="shieldText" class="v">0</span></div>
        <div class="stat"><span class="k">â­</span> <span id="scoreText" class="v">0</span></div>
        <div class="stat floor-stat"><span class="k">ğŸ° Floor</span> <span id="floorText" class="v">1</span></div>
      </div>
    </header>

    <!-- Turn Phase Banner -->
    <div id="turnBanner" class="turn-banner hidden">
      <span id="turnText">Your Turn</span>
    </div>

    <section class="boardWrap">
      <!-- Combat Log (inside boardWrap for proper positioning) -->
      <div id="combatLog" class="combat-log">
        <div id="combatLogContent" class="combat-log-content"></div>
      </div>
      <canvas id="game" width="640" height="640" aria-label="Game board"></canvas>
      
      <!-- Action Preview Tooltip -->
      <div id="actionPreview" class="action-preview hidden">
        <span id="actionText">Attack 5</span>
      </div>

      <!-- Floor Progress -->
      <div class="floor-progress">
        <span id="floorProgressText" class="floor-progress-text">0/5 slain</span>
        <div class="floor-bar-bg">
          <div id="floorBar" class="floor-bar-fill" style="width: 0%"></div>
        </div>
      </div>
      
      <!-- Monster Info Panel -->
      <div id="monsterInfo" class="monster-info hidden">
        <span id="monsterIcon" class="monster-icon">ğŸ€</span>
        <div class="monster-details">
          <span id="monsterName" class="monster-name">Slime</span>
          <span id="monsterHp" class="monster-hp">HP: 3/3</span>
        </div>
      </div>

      <!-- Threat Indicator -->
      <div id="threatIndicator" class="threat-indicator">
        <span class="threat-label">âš ï¸ Threat:</span>
        <span id="threatCount" class="threat-count">0</span>
        <span class="threat-dmg">dmg/turn</span>
      </div>

      <!-- Surge UI -->
      <div class="surge-container">
        <div class="surge-bar-bg">
          <div id="surgeBar" class="surge-bar-fill" style="width: 0%"></div>
        </div>
        <button id="surgeBtn" class="btn surge-btn" disabled>âš¡ SURGE!</button>
      </div>

      <div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-label="Help">
        <div class="card">
          <h1 id="overlayTitle">How to play</h1>
          <p id="overlayMessage" class="overlayMsg"></p>
          <ul id="overlayHelp">
            <li class="help-section"><b>âš”ï¸ THE BATTLE</b></li>
            <li>You're a dungeon crawler! <b>Monsters</b> appear on the board - Slimes, Goblins, Wraiths and more!</li>
            <li>Each turn: <b>YOU act first</b>, then <b>ALL monsters attack you</b> for 1 damage each!</li>
            <li>Kill 5+ monsters per floor to advance deeper into the dungeon.</li>
            
            <li class="help-section"><b>ğŸ® HOW TO FIGHT</b></li>
            <li><span class="sw s-sword"></span> <b>Sword âš”ï¸</b>: Drag a chain of swords INTO a monster to attack it!</li>
            <li><span class="sw s-potion"></span> <b>Heart â¤ï¸</b>: Chain 3+ hearts to heal yourself.</li>
            <li><span class="sw s-shield"></span> <b>Shield ğŸ›¡ï¸</b>: Chain 3+ shields to block monster attacks.</li>
            <li><span class="sw s-coin"></span> <b>Gold ğŸ’°</b>: Chain 3+ coins for points & charge your Surge power.</li>
            <li><span class="sw s-wild"></span> <b>Wild âœ¨</b>: Rare! Matches with anything for big combos!</li>
            
            <li class="help-section"><b>ğŸ’¡ TIPS</b></li>
            <li>ğŸ”¥ <b>Longer chains = bigger bonuses!</b> (4+ tiles = 25%, 5+ = 50%, 6+ = 100%!)</li>
            <li>âš¡ <b>Surge Power:</b> When full, transmutes ALL monsters into gold!</li>
          </ul>
          <div class="row">
            <button id="startBtn" class="btn primary">Start Run</button>
            <button id="closeHelpBtn" class="btn">Close</button>
          </div>
          <p class="hint">ğŸ’€ Watch out! Every monster on the board attacks after your turn!</p>
        </div>
      </div>
    </section>

    <section class="controls" aria-label="Controls">
      <div class="buttons">
        <button id="newBtn" class="btn">New Run</button>
        <button id="helpBtn" class="btn">Help (?)</button>
      </div>
      <!-- Log removed or simplified? Let's keep a small log if needed, or remove it for cleanliness. 
           The prompt mentions "easier to understand", visuals are better than logs. 
           I'll keep a minimal log but maybe hide it or style it smaller.
           Actually, let's keep it but make it small. -->
      <div class="log" style="display:none;"> <!-- Hidden by default, maybe use for debugging or critical info -->
        <div id="log" class="logBody"></div>
      </div>
    </section>
  </main>

  <script src="./game.js"></script>
</body>
</html>
